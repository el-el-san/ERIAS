# ERIAS - Discord+Slack連携 自律型AI開発エージェント

ERIASは、複数のメッセージングプラットフォーム（Discord、Slack）を通じて動作する自律型AI開発エージェントです。ユーザーの指示に基づいて、プロジェクトの計画、コード生成、テスト、デバッグを自動で実行します。

## 特徴

- 🤖 **AIによる自律的な開発**: Google Gemini APIを活用し、プロジェクト開発を自動化
- 💬 **マルチプラットフォーム対応**: Discord、Slackなど複数のメッセージングプラットフォームをサポート
- 🔄 **リアルタイムフィードバック**: 開発中に追加の指示やフィードバックを提供可能
- 📊 **進捗モニタリング**: プロジェクトの進捗状況をリアルタイムで確認
- 🛠️ **GitHub連携**: リポジトリのクローン、ブランチ作成、プルリクエスト作成を自動化
- 🎨 **画像生成機能**: 通常の会話で画像生成リクエストを受け付け、Gemini 2.0 Flashを使用して高品質な画像を生成

## 現状の実装

現在のERIASは以下の実装状況です：

- **マルチプラットフォーム対応基盤**: PlatformManager、各プラットフォームアダプター（Discord、Slack）の基本実装完了
- **基本的なコマンドシステム**: プロジェクト作成、ステータス確認、キャンセル、ヘルプ、GitHub連携の各コマンド定義と登録の仕組みを実装
- **タスク管理システム**: タスクのライフサイクル管理、進捗追跡、通知機能の基本フレームワーク構築済み
- **画像生成機能**: Gemini 2.0 Flash APIを使用した基本的な画像生成とプロンプト最適化の仕組みを実装
- **LLM連携**: Gemini APIとの連携、会話履歴管理、基本的なプロンプト生成の仕組みを実装
- **プロジェクト生成機能**: 計画立案、コード生成、テスト、デバッグ、ユーザーフィードバック処理の一連のプロセスを自動化

### GitHub連携機能の実装状況

**GitHubサービス**では以下の機能を実装済みです：

- **リポジトリ分析**: 詳細なコード構造、依存関係、言語パターンの分析
- **コード生成エンジン**: 多言語対応（TypeScript, JavaScript, Python）のテンプレートシステム
- **ブランチ管理**: ブランチの自動作成と管理
- **PRレビュー機能**: AIによる自動コードレビューとPRコメント生成
- **フィードバック処理**: ユーザーのフィードバックに基づく機能追加・修正
- **エンドツーエンド自動化**: リポジトリクローンからプルリクエストマージまでの全自動処理

### 新たに追加された機能

- **拡張リポジトリ分析器**: 深いコード理解と言語検出機能による高精度分析
- **言語別コード生成テンプレート**: TypeScriptとPythonに対応した高品質テンプレート
- **LLM統合**: Gemini APIを活用した高度なコード生成と文脈理解
- **GitHubフロー自動化**: タスク記述から具体的な実装、PRまでを自動化
- **コマンドハンドラー拡張**: 新たなGitHub連携コマンドによる操作性向上
- **モジュール化されたGitHubサービス**: 責任分離による保守性と拡張性の向上

## システムアーキテクチャ

### コアコンポーネント

- **AgentCore**: 開発プロセス全体のオーケストレーション、タスク管理
- **PlatformManager**: 各メッセージングプラットフォームのアダプター管理
- **ProjectGenerator**: プロジェクト生成の全体プロセスを管理
- **EnhancedGitHubExecutor**: GitHub関連タスクの高度な実行
- **RepositoryAnalyzer**: リポジトリの詳細分析
- **CodeGenerator**: コード生成、依存関係管理
- **LLMIntegration**: Gemini APIとの高度な連携
- **ImageGenerator**: Gemini 2.0 Flashによる画像生成機能
- **PlatformAdapter**: プラットフォーム固有の実装を抽象化

### 主要機能

1. **プロジェクト生成**
   - 要件定義から完成までの全工程を自動化
   - 技術スタックの選定、ファイル構造の設計
   - コード生成、依存関係のインストール
   - テスト実行とデバッグ
   - README.mdの自動生成
   - 完成プロジェクトのZIPアーカイブ化

2. **GitHub連携**
   - リポジトリの詳細分析（言語、フレームワーク、依存関係）
   - タスク内容に基づく最適なファイル生成
   - 様々な言語に対応したコード自動生成
   - プルリクエストの作成とレビュー
   - ユーザーフィードバックに基づく機能追加・修正

3. **リアルタイムフィードバック**
   - 開発中の任意のタイミングでフィードバック提供
   - 緊急指示や機能追加のリクエストに対応
   - GitHub連携タスクへの特殊タグによる指示（#feature, #fix, file:パス）

4. **画像生成**
   - 通常の会話で「〜の画像を生成して」と入力するだけで画像生成
   - Gemini 2.0 Flash APIを使用した高品質な画像生成
   - 生成された画像はDiscordやSlackに直接送信

5. **マルチプラットフォーム対応**
   - Discord、Slackなど複数のプラットフォームをサポート
   - 抽象化レイヤーによる拡張性の高い設計
   - 将来的に新しいプラットフォームを追加可能

### GitHubサービスの最新アーキテクチャ

GitHub連携機能は以下のモジュールに分割されて実装されています：

- **GitHubServiceBase**: 共通の基底クラスと機能
- **RepositoryService**: リポジトリとブランチの操作
- **FileService**: ファイル操作関連の機能
- **PullRequestService**: PR作成とレビュー機能
- **FeatureService**: 機能実装関連の機能
- **EnhancedGitHubService**: 各モジュールを統合したファサードクラス

この構造により、各機能の責任が明確に分離され、保守性と拡張性が向上しています。

## 使用方法

### インストール

```bash
# リポジトリのクローン
git clone https://github.com/el-el-san/ERIAS.git
cd ERIAS

# 依存関係のインストール
npm install

# ビルド
npm run build
```

### 設定

1. `.env.example`を`.env`にコピー
2. 必要な環境変数を設定

### 起動

```bash
npm start
```

## コマンド

### 基本コマンド (Discord, Slack共通)

- `/newproject [仕様]` - 新しいプロジェクトを生成
- `/status [タスクID]` - プロジェクトの進捗状況を確認
- `/cancel [タスクID]` - 実行中のプロジェクトをキャンセル
- `/help` - ヘルプを表示

### GitHub連携コマンド

- `/githubrepo [リポジトリURL] [タスク]` - 既存リポジトリに機能を追加
- `/generatefile [リポジトリURL] [ファイルパス] [説明]` - 特定のファイルを生成
- `/reviewpr [リポジトリURL] [PR番号]` - PRをレビュー

### フィードバック機能

実行中のプロジェクトに対して追加の指示を提供できます：

```
task:タスクID [指示内容]
```

特殊タグ：
- `#urgent` または `#緊急` - 緊急の指示として処理
- `#feature` または `#機能` - 新機能の追加
- `#fix` または `#修正` - バグ修正
- `#code` または `#コード` - コード修正
- `file:パス` - 特定ファイルへの指示

### 画像生成機能

通常の会話で画像生成をリクエストできます：

```
「○○の画像を生成して」
「○○のイメージを作って」
"generate image of ..."
"create an image of ..."
```

ERIASが自動的に生成リクエストを検出し、適切なプロンプトを最適化してGemini 2.0 Flashを使用して画像を出力します。

## トラブルシューティング

### 既知の問題と解決策

- **gitignoreによるコミット失敗**: `.gitignore`ファイルでGitHubリポジトリディレクトリが除外されている場合、`-f`オプションを使ってコミットを強制します。
- **LLM応答のJSON解析エラー**: Gemini APIからのレスポンスが正しいJSON形式でない場合があります。プロンプトでJSON形式を明示的に要求し、応答の解析ロジックを改善しています。

### エラーハンドリングの改善

- エラーログの詳細化と一元管理
- 復旧メカニズムの強化
- ユーザーへのエラー通知の改善

## 開発の次のステップ

現状の実装を踏まえ、今後の開発予定は以下の通りです：

1. **GitHub連携のさらなる強化**
   - より多くのプログラミング言語への対応拡充
   - コード解析・最適化機能の向上
   - AIによるPRレビュー品質の向上

2. **フィードバックシステムの強化**
   - より複雑なフィードバック指示の理解
   - コンテキスト認識の向上
   - ユーザーとの自然な対話によるソフトウェア改善

3. **UI/UXの改善**
   - プラットフォーム固有の機能活用
   - インタラクティブな要素の追加
   - ビジュアルフィードバックの強化

4. **LLM連携の最適化**
   - プロンプトエンジニアリングの強化
   - コンテキスト管理の向上
   - 最新のGeminiモデルへの対応

5. **テスト自動化の強化**
   - テストカバレッジの向上
   - 継続的インテグレーション/デプロイメントの導入
   - 自動的なバグ検出・修正機能

## 依存ライブラリ

- Discord.js v14.14.1
- Slack Bolt API v3.14.0
- Google Genai v0.10.0 / Generative-AI v0.24.0
- @octokit/rest v18.12.0
- Simple-Git v3.27.0
- その他ユーティリティライブラリ

## ライセンス

MIT License